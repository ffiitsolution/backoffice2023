<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="reportInventoryMovement" pageWidth="626" pageHeight="842" columnWidth="586" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="06b530b0-c9da-4324-8953-10ae8fc23de2">
    <property name="ireport.zoom" value="1.6105100000000134"/>
    <property name="ireport.x" value="0"/>
    <property name="ireport.y" value="0"/>
    <parameter name="fromDate" class="java.lang.String"/>
    <parameter name="toDate" class="java.lang.String"/>
    <parameter name="outletCode" class="java.lang.String">
        <defaultValueExpression><![CDATA[]]></defaultValueExpression>
    </parameter>
    <parameter name="query1" class="java.lang.String" isForPrompting="false">
        <defaultValueExpression><![CDATA["1 = 1"]]></defaultValueExpression>
    </parameter>
    <parameter name="user" class="java.lang.String"/>
    <parameter name="query2" class="java.lang.String" isForPrompting="false">
        <defaultValueExpression><![CDATA["1 = 1"]]></defaultValueExpression>
    </parameter>
    <queryString>
        <![CDATA[SELECT
	a.OUTLET_CODE,
	a.ITEM_CODE,
	b.ITEM_DESCRIPTION,
	b.CONV_STOCK,
	b.UOM_STOCK,
	b.UOM_PURCHASE,
	SUM(a."BEGIN") AS STOCK_BEGIN,
	SUM(a.RCVIN)+SUM(a.RCVOUT)+SUM(a.DELIN)+SUM(a.PRDIN) AS QTY_IN,
	SUM(a.RCVOUT)+SUM(a.SLSOUT)+SUM(a.DELOUT)+SUM(a.LOCOUT)+SUM(a.LOVOUT)+SUM(a.FMLOUT)+SUM(a.DLVOUT)+SUM(a.WSTOUT)+SUM(a.RTROUT)+SUM(a.PRDOUT) AS QTY_OUT,
	SUM(a.SOPIN)-SUM(a.SOPOUT) AS adjustment,
	(SUM(a."BEGIN")+SUM(a.RCVIN)+SUM(a.SLSIN)+SUM(a.DELIN)+SUM(a.LOCIN)+SUM(a.LOVIN)+SUM(a.FMLIN)+SUM(a.DLVIN)+SUM(a.WSTIN)+SUM(a.RTRIN)+SUM(a.PRDIN)+SUM(a.SOPIN))-
	(SUM(a.RCVOUT)+SUM(a.SLSOUT)+SUM(a.DELOUT)+SUM(a.LOCOUT)+SUM(a.LOVOUT)+SUM(a.FMLOUT)+SUM(a.DLVOUT)+SUM(a.WSTOUT)+SUM(a.RTROUT)+SUM(a.PRDOUT)+SUM(a.SOPOUT)) AS ENDING,
	c.OUTLET_NAME,
	c.ADDRESS_1
FROM
	(
	SELECT
		OUTLET_CODE,
		ITEM_CODE,
		CASE
			WHEN CD_TRANS = 'SAL' THEN QTY_IN
			ELSE 0
		END AS "BEGIN",
		CASE
			WHEN CD_TRANS = 'RCV' THEN QTY_IN
			ELSE 0
		END
                                AS RCVIN,
		CASE
			WHEN CD_TRANS = 'RCV' THEN QTY_OUT
			ELSE 0
		END
                                AS RCVOUT,
		CASE
			WHEN CD_TRANS = 'SLS' THEN QTY_IN
			ELSE 0
		END
                                AS SLSIN,
		CASE
			WHEN CD_TRANS = 'SLS' THEN QTY_OUT
			ELSE 0
		END
                                AS SLSOUT,
		CASE
			WHEN CD_TRANS = 'DEL' THEN QTY_IN
			ELSE 0
		END
                                AS DELIN,
		CASE
			WHEN CD_TRANS = 'DEL' THEN QTY_OUT
			ELSE 0
		END
                                AS DELOUT,
		CASE
			WHEN CD_TRANS = 'LOC' THEN QTY_IN
			ELSE 0
		END
                                AS LOCIN,
		CASE
			WHEN CD_TRANS = 'LOC' THEN QTY_OUT
			ELSE 0
		END
                                AS LOCOUT,
		CASE
			WHEN CD_TRANS = 'LOV' THEN QTY_IN
			ELSE 0
		END
                                AS LOVIN,
		CASE
			WHEN CD_TRANS = 'LOV' THEN QTY_OUT
			ELSE 0
		END
                                AS LOVOUT,
		CASE
			WHEN CD_TRANS = 'FML' THEN QTY_IN
			ELSE 0
		END
                                AS FMLIN,
		CASE
			WHEN CD_TRANS = 'FML' THEN QTY_OUT
			ELSE 0
		END
                                AS FMLOUT,
		CASE
			WHEN CD_TRANS = 'DLV' THEN QTY_IN
			ELSE 0
		END
                                AS DLVIN,
		CASE
			WHEN CD_TRANS = 'DLV' THEN QTY_OUT
			ELSE 0
		END
                                AS DLVOUT,
		CASE
			WHEN CD_TRANS = 'WST' THEN QTY_IN
			ELSE 0
		END
                                AS WSTIN,
		CASE
			WHEN CD_TRANS = 'WST' THEN QTY_OUT
			ELSE 0
		END
                                AS WSTOUT,
		CASE
			WHEN CD_TRANS = 'RTR' THEN QTY_IN
			ELSE 0
		END
                                AS RTRIN,
		CASE
			WHEN CD_TRANS = 'RTR' THEN QTY_OUT
			ELSE 0
		END
                                AS RTROUT,
		CASE
			WHEN CD_TRANS = 'PRD' THEN QTY_IN
			ELSE 0
		END
                                AS PRDIN,
		CASE
			WHEN CD_TRANS = 'PRD' THEN QTY_OUT
			ELSE 0
		END
                                AS PRDOUT,
		CASE
			WHEN CD_TRANS = 'SOP' THEN QTY_IN
			ELSE 0
		END
                                AS SOPIN,
		CASE
			WHEN CD_TRANS = 'SOP' THEN QTY_OUT
			ELSE 0
		END
                                AS SOPOUT
	FROM
		(
		SELECT
			outlet_code,
			item_code,
			QTY_BEGINNING AS QTY_IN,
			0 AS QTY_out,
			'SAL' AS cd_trans
		FROM
			t_stock_card
		WHERE
			trans_date = $P{fromDate}
			AND OUTLET_CODE = $P{outletCode}
			AND $P!{query1}
	UNION ALL
		SELECT
			outlet_code,
			item_code,
			sum(quantity_in) qty_in,
			sum(quantity)qty_out,
			cd_trans
		FROM
			t_stock_card_detail
		WHERE
			trans_date BETWEEN $P{fromDate} AND $P{toDate}
			AND OUTLET_CODE = $P{outletCode}
			AND $P!{query2}
		GROUP BY
			outlet_code,
			item_code,
			cd_trans))a
LEFT JOIN
	M_ITEM b ON
	a.ITEM_CODE = b.ITEM_CODE
JOIN
	M_OUTLET c ON
	a.OUTLET_CODE = c.OUTLET_CODE
GROUP BY
	a.OUTLET_CODE,
	a.ITEM_CODE,
	b.ITEM_DESCRIPTION,
	b.CONV_STOCK,
	b.UOM_STOCK,
	b.UOM_PURCHASE,
	c.OUTLET_NAME,
	c.ADDRESS_1
ORDER BY
	a.ITEM_CODE ASC]]>
    </queryString>
    <field name="OUTLET_CODE" class="java.lang.String"/>
    <field name="ITEM_CODE" class="java.lang.String"/>
    <field name="ITEM_DESCRIPTION" class="java.lang.String"/>
    <field name="CONV_STOCK" class="java.math.BigDecimal"/>
    <field name="UOM_STOCK" class="java.lang.String"/>
    <field name="UOM_PURCHASE" class="java.lang.String"/>
    <field name="STOCK_BEGIN" class="java.math.BigDecimal"/>
    <field name="QTY_IN" class="java.math.BigDecimal"/>
    <field name="QTY_OUT" class="java.math.BigDecimal"/>
    <field name="ADJUSTMENT" class="java.math.BigDecimal"/>
    <field name="ENDING" class="java.math.BigDecimal"/>
    <field name="OUTLET_NAME" class="java.lang.String"/>
    <field name="ADDRESS_1" class="java.lang.String"/>
    <background>
        <band splitType="Stretch"/>
    </background>
    <pageHeader>
        <band height="102" splitType="Stretch">
            <staticText>
                <reportElement x="64" y="3" width="112" height="11" uuid="273fa430-1da2-4f87-8eae-02cf63c20e05"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <text><![CDATA[PT. Fastfood Indonesia, Tbk]]></text>
            </staticText>
            <textField>
                <reportElement x="64" y="14" width="165" height="11" uuid="8a229328-adaa-449c-9a56-6aa4cf09dc56"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{OUTLET_NAME}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement x="64" y="24" width="165" height="11" uuid="cc480b68-68a2-443f-8bf2-1c1945555575"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{ADDRESS_1}]]></textFieldExpression>
            </textField>
            <staticText>
                <reportElement x="1" y="42" width="555" height="18" uuid="979d11b6-4453-48cc-9a16-5902665bc3cc"/>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font size="11" isBold="true"/>
                </textElement>
                <text><![CDATA[INVENTORY MOVEMENT]]></text>
            </staticText>
            <staticText>
                <reportElement x="0" y="85" width="39" height="15" uuid="6e25febd-dbe8-4d60-ad32-d70352c23d2b"/>
                <textElement>
                    <font size="8" isBold="true"/>
                </textElement>
                <text><![CDATA[Item]]></text>
            </staticText>
            <staticText>
                <reportElement x="38" y="85" width="233" height="15" uuid="c3876a0b-3364-471d-b305-3dad5823f144"/>
                <textElement>
                    <font size="8" isBold="true"/>
                </textElement>
                <text><![CDATA[Desctiption]]></text>
            </staticText>
            <staticText>
                <reportElement x="252" y="85" width="56" height="15" uuid="e14bd2f9-b710-4088-bf02-dc29f9cc572f"/>
                <textElement>
                    <font size="8" isBold="true"/>
                </textElement>
                <text><![CDATA[Conversion]]></text>
            </staticText>
            <staticText>
                <reportElement x="308" y="85" width="56" height="15" uuid="372d8acc-257a-40bd-9089-c2406144d5c6"/>
                <textElement textAlignment="Right">
                    <font size="8" isBold="true"/>
                </textElement>
                <text><![CDATA[Begin]]></text>
            </staticText>
            <staticText>
                <reportElement x="364" y="85" width="56" height="15" uuid="440568c3-c1be-4aaa-ae7e-a0fcc03ed188"/>
                <textElement textAlignment="Right">
                    <font size="8" isBold="true"/>
                </textElement>
                <text><![CDATA[In]]></text>
            </staticText>
            <staticText>
                <reportElement x="420" y="85" width="56" height="15" uuid="dbc7fb90-0b29-4559-9db6-6e1650f02549"/>
                <textElement textAlignment="Right">
                    <font size="8" isBold="true"/>
                </textElement>
                <text><![CDATA[Out]]></text>
            </staticText>
            <staticText>
                <reportElement x="530" y="85" width="56" height="15" uuid="1b74f55f-4491-4898-8102-683d5aaad3f2"/>
                <textElement textAlignment="Right">
                    <font size="8" isBold="true"/>
                </textElement>
                <text><![CDATA[Ending]]></text>
            </staticText>
            <line>
                <reportElement x="0" y="83" width="586" height="1" uuid="af02ac7c-7831-4aae-a33f-675362fd0300"/>
            </line>
            <line>
                <reportElement x="0" y="101" width="586" height="1" uuid="11bdebf2-6510-496d-9eb4-36b085d3f145"/>
            </line>
            <textField>
                <reportElement x="103" y="61" width="347" height="11" uuid="f2468062-21d1-434b-9171-09ca9c5654a7"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[" : " + new SimpleDateFormat("dd/MM/yyyy").format(new SimpleDateFormat("dd-MMM-yy").parse($P{fromDate}))
+ " s/d " + new SimpleDateFormat("dd/MM/yyyy").format(new SimpleDateFormat("dd-MMM-yy").parse($P{toDate}))]]></textFieldExpression>
            </textField>
            <staticText>
                <reportElement x="1" y="61" width="103" height="11" uuid="c5ec79f3-ee5a-424e-b241-9a0540add804"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <text><![CDATA[Periode     ]]></text>
            </staticText>
            <staticText>
                <reportElement x="450" y="61" width="65" height="11" uuid="33f5770d-b92f-4a3e-a1b9-4fcfd15d789b"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <text><![CDATA[Page   ]]></text>
            </staticText>
            <textField>
                <reportElement x="514" y="61" width="100" height="11" uuid="1b510faf-542f-47ab-9022-2552e137bfff"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[" : " + $V{PAGE_NUMBER}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement x="103" y="71" width="150" height="11" uuid="c6651ef8-9a48-490a-b252-67a68e1aa96a"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[" : " + new SimpleDateFormat("dd/MM/yyyy hh:mm:ss").format(new Date())]]></textFieldExpression>
            </textField>
            <staticText>
                <reportElement x="1" y="71" width="103" height="11" uuid="a4c11d39-d851-4218-a966-9ba2a47f4219"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <text><![CDATA[Tanggal dan Jam Cetak ]]></text>
            </staticText>
            <staticText>
                <reportElement x="450" y="71" width="65" height="11" uuid="75976a07-b099-41f9-9127-e1ee58536393"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <text><![CDATA[Di Cetak Oleh]]></text>
            </staticText>
            <textField>
                <reportElement x="514" y="71" width="150" height="11" uuid="11cc1503-e7a7-419b-9163-8886f2567547"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[" : " + $P{user}]]></textFieldExpression>
            </textField>
            <image>
                <reportElement x="8" y="1" width="56" height="42" isPrintWhenDetailOverflows="true" uuid="bbc05668-ec08-418f-83d2-4010a2c63141"/>
                <imageExpression><![CDATA["logo/logoKfc.png"]]></imageExpression>
            </image>
            <staticText>
                <reportElement x="476" y="85" width="54" height="15" uuid="c1e0af6b-3b53-4d31-81a0-ffd787249b81"/>
                <textElement textAlignment="Right">
                    <font size="8" isBold="true"/>
                </textElement>
                <text><![CDATA[Adjustment]]></text>
            </staticText>
        </band>
    </pageHeader>
    <detail>
        <band height="20" splitType="Stretch">
            <textField>
                <reportElement x="0" y="0" width="39" height="15" uuid="96a05c70-4b29-4b3e-b439-5bf4318b77ec"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{ITEM_CODE}]]></textFieldExpression>
            </textField>
            <textField textAdjust="StretchHeight">
                <reportElement x="38" y="0" width="233" height="15" uuid="df41de09-c5ec-46d6-858b-c6c770d1cd15"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{ITEM_DESCRIPTION}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement x="252" y="0" width="72" height="15" uuid="5ee23171-51d7-4bfc-9d5f-0913c886a1b3"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{CONV_STOCK} + " " + $F{UOM_STOCK} + "/" + $F{UOM_PURCHASE}]]></textFieldExpression>
            </textField>
            <textField pattern="#,##0">
                <reportElement x="308" y="0" width="56" height="15" uuid="d3a57d89-f578-4338-90c2-568c24ce2c47"/>
                <textElement textAlignment="Right">
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{STOCK_BEGIN}]]></textFieldExpression>
            </textField>
            <textField pattern="#,##0">
                <reportElement x="364" y="0" width="56" height="15" uuid="fff62d4a-bdd0-4772-91c1-2cab17db4566"/>
                <textElement textAlignment="Right">
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{QTY_IN}]]></textFieldExpression>
            </textField>
            <textField pattern="#,##0">
                <reportElement x="420" y="0" width="56" height="15" uuid="de28401b-f266-49fd-b4af-2ec7fa179600"/>
                <textElement textAlignment="Right">
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{QTY_OUT}]]></textFieldExpression>
            </textField>
            <textField pattern="#,##0">
                <reportElement x="530" y="0" width="56" height="15" uuid="8663877d-64ab-40d3-a0ed-7e642b5097b8"/>
                <textElement textAlignment="Right">
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{ENDING}]]></textFieldExpression>
            </textField>
            <textField pattern="#,##0">
                <reportElement x="476" y="0" width="54" height="15" uuid="1dda1398-9302-4ef2-8e09-bd33759e166f"/>
                <textElement textAlignment="Right">
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{ADJUSTMENT}]]></textFieldExpression>
            </textField>
        </band>
    </detail>
    <pageFooter>
        <band height="9" splitType="Stretch"/>
    </pageFooter>
    <summary>
        <band height="11" splitType="Stretch"/>
    </summary>
</jasperReport>
