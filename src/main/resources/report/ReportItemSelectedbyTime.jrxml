<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="ReportItemSelectedbyTime" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="d1bdcdf7-880f-4e24-abaa-541a541b5879">
    <property name="ireport.zoom" value="1.6105100000000077"/>
    <property name="ireport.x" value="0"/>
    <property name="ireport.y" value="0"/>
    <parameter name="outletCode" class="java.lang.String">
        <defaultValueExpression><![CDATA[]]></defaultValueExpression>
    </parameter>
    <parameter name="fromDate" class="java.lang.String">
        <defaultValueExpression><![CDATA[]]></defaultValueExpression>
    </parameter>
    <parameter name="toDate" class="java.lang.String">
        <defaultValueExpression><![CDATA[]]></defaultValueExpression>
    </parameter>
    <parameter name="kodeItem" class="java.lang.String">
        <defaultValueExpression><![CDATA[]]></defaultValueExpression>
    </parameter>
    <queryString>
        <![CDATA[SELECT
	a.*,
	b.OUTLET_NAME
FROM
	(
	SELECT
		menu_item_code,
		item_description,
		waktu,
		MAX (decode(TRANS_TYPE, 'EI', TOTAL, 0)) EI_QTY,
		MAX (decode(TRANS_TYPE, 'TA', TOTAL, 0)) TA_QTY,
		$P{outletCode} AS outlet_Code
	FROM
		(
		SELECT
			menu_item_code,
			item_description,
			trans_type,
			sum(item_qty) AS total,
			waktu
		FROM
			(
			SELECT
				a.menu_item_code,
				c.item_description,
				CASE
					WHEN a.trans_type = 'EI' THEN 'EI'
					WHEN a.trans_type = 'TA' THEN 'TA'
					WHEN a.trans_type = ' ' THEN 'TA'
					WHEN a.trans_type IS NULL THEN 'TA'
					ELSE 'TA'
				END AS trans_type,
				a.item_qty,
				CASE
					WHEN b.bill_time BETWEEN '000000' AND '005959' THEN '00-01'
					WHEN b.bill_time BETWEEN '010000' AND '015959' THEN '01-02'
					WHEN b.bill_time BETWEEN '020000' AND '025959' THEN '02-03'
					WHEN b.bill_time BETWEEN '030000' AND '035959' THEN '03-04'
					WHEN b.bill_time BETWEEN '040000' AND '045959' THEN '04-05'
					WHEN b.bill_time BETWEEN '050000' AND '055959' THEN '05-06'
					WHEN b.bill_time BETWEEN '060000' AND '065959' THEN '06-07'
					WHEN b.bill_time BETWEEN '070000' AND '075959' THEN '07-08'
					WHEN b.bill_time BETWEEN '080000' AND '085959' THEN '08-09'
					WHEN b.bill_time BETWEEN '090000' AND '095959' THEN '09-10'
					WHEN b.bill_time BETWEEN '100000' AND '105959' THEN '10-11'
					WHEN b.bill_time BETWEEN '110000' AND '115959' THEN '11-12'
					WHEN b.bill_time BETWEEN '120000' AND '125959' THEN '12-13'
					WHEN b.bill_time BETWEEN '130000' AND '135959' THEN '13-14'
					WHEN b.bill_time BETWEEN '140000' AND '145959' THEN '14-15'
					WHEN b.bill_time BETWEEN '150000' AND '155959' THEN '15-16'
					WHEN b.bill_time BETWEEN '160000' AND '165959' THEN '16-17'
					WHEN b.bill_time BETWEEN '170000' AND '175959' THEN '17-18'
					WHEN b.bill_time BETWEEN '180000' AND '185959' THEN '18-19'
					WHEN b.bill_time BETWEEN '190000' AND '195959' THEN '19-20'
					WHEN b.bill_time BETWEEN '200000' AND '205959' THEN '20-21'
					WHEN b.bill_time BETWEEN '210000' AND '215959' THEN '21-22'
					WHEN b.bill_time BETWEEN '220000' AND '225959' THEN '22-23'
					WHEN b.bill_time BETWEEN '230000' AND '235959' THEN '23-00'
					ELSE 'aneh'
				END AS waktu
			FROM
				t_pos_bill_item a
			JOIN t_pos_bill b ON
				a.outlet_code = b.outlet_code
				AND a.pos_code = b.pos_code
				AND a.bill_no = b.bill_no
				AND a.trans_date = b.trans_date
				AND b.delivery_status = 'CLS'
				AND a.menu_item_code = $P{kodeItem}
				AND a.trans_date BETWEEN $P{fromDate} AND $P{toDate}
				AND a.outlet_code = $P{outletCode}
			JOIN m_item c ON
				a.menu_item_code = c.item_code
)
		GROUP BY
			menu_item_code,
			item_description,
			trans_type,
			waktu
)
	GROUP BY
		menu_item_code,
		item_description,
		waktu
	ORDER BY
		menu_item_code,
		waktu) a
LEFT JOIN M_OUTLET b ON
	a.outlet_Code = b.OUTLET_CODE]]>
    </queryString>
    <field name="MENU_ITEM_CODE" class="java.lang.String"/>
    <field name="ITEM_DESCRIPTION" class="java.lang.String"/>
    <field name="WAKTU" class="java.lang.String"/>
    <field name="EI_QTY" class="java.lang.Integer"/>
    <field name="TA_QTY" class="java.lang.Integer"/>
    <field name="OUTLET_CODE" class="java.lang.String"/>
    <field name="OUTLET_NAME" class="java.lang.String"/>
    <variable name="totalQtyEI" class="java.lang.Integer" calculation="Sum">
        <variableExpression><![CDATA[$F{EI_QTY}]]></variableExpression>
    </variable>
    <variable name="totalQtyTA" class="java.lang.Integer" calculation="Sum">
        <variableExpression><![CDATA[$F{TA_QTY}]]></variableExpression>
    </variable>
    <background>
        <band splitType="Stretch"/>
    </background>
    <columnHeader>
        <band height="91" splitType="Stretch">
            <image>
                <reportElement x="18" y="1" width="56" height="42" isPrintWhenDetailOverflows="true" uuid="1afa8097-3dad-458f-9759-fb039c87ee55"/>
                <imageExpression><![CDATA["logo/logoKfc.png"]]></imageExpression>
            </image>
            <staticText>
                <reportElement x="77" y="0" width="112" height="11" uuid="20c2b1e9-1a41-4942-8362-ef88eff3bf9c"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <text><![CDATA[PT. Fastfood Indonesia, Tbk]]></text>
            </staticText>
            <staticText>
                <reportElement x="1" y="47" width="56" height="11" uuid="1c535b10-d51f-4d11-8c30-39fc04692d3f"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <text><![CDATA[OUTLET]]></text>
            </staticText>
            <staticText>
                <reportElement x="1" y="57" width="56" height="11" uuid="5f5adfcf-4406-4639-8e9d-4dd2448c3ff9"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <text><![CDATA[ITEM CODE]]></text>
            </staticText>
            <textField>
                <reportElement x="56" y="47" width="62" height="11" uuid="4257907c-630a-4b16-968b-2a8197776531"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[$P{outletCode}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement x="56" y="57" width="62" height="11" uuid="4d299f81-6bad-4da3-9cc3-b462841b6da5"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[$P{kodeItem}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement x="117" y="47" width="194" height="11" uuid="996c5042-939b-473f-b212-b5fdf5e1e907"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{OUTLET_NAME}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement x="117" y="57" width="194" height="11" uuid="a6a83287-65ec-46f6-866e-374677c47496"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{ITEM_DESCRIPTION}]]></textFieldExpression>
            </textField>
            <staticText>
                <reportElement x="354" y="1" width="241" height="18" uuid="ee2b2790-2612-4ef1-9086-665887e97036"/>
                <textElement>
                    <font size="12" isBold="true"/>
                </textElement>
                <text><![CDATA[Report Item Selected by Time]]></text>
            </staticText>
            <staticText>
                <reportElement x="1" y="75" width="56" height="11" uuid="3cab3a52-c557-4b95-8643-0c32719e430e"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <text><![CDATA[TIME]]></text>
            </staticText>
            <staticText>
                <reportElement x="56" y="75" width="148" height="11" uuid="37ef351a-14fa-49cf-adf7-7f3ae572c057"/>
                <textElement textAlignment="Right">
                    <font size="8"/>
                </textElement>
                <text><![CDATA[QTY.EI]]></text>
            </staticText>
            <staticText>
                <reportElement x="203" y="75" width="148" height="11" uuid="11bf3ff4-34f3-4258-8b42-8f960e1f4b29"/>
                <textElement textAlignment="Right">
                    <font size="8"/>
                </textElement>
                <text><![CDATA[QTY.TA]]></text>
            </staticText>
            <staticText>
                <reportElement x="350" y="75" width="148" height="11" uuid="0aa73715-c216-418a-8040-34df85dad548"/>
                <textElement textAlignment="Right">
                    <font size="8"/>
                </textElement>
                <text><![CDATA[TOTAL]]></text>
            </staticText>
            <line>
                <reportElement x="1" y="73" width="554" height="1" uuid="fd22bcc2-df19-4372-8f20-ec4923a0d8bb"/>
            </line>
            <line>
                <reportElement x="1" y="87" width="554" height="1" uuid="22571fbb-fbc7-47a6-a9ed-d9d2b14fcb75"/>
            </line>
        </band>
    </columnHeader>
    <detail>
        <band height="20" splitType="Stretch">
            <textField>
                <reportElement x="1" y="0" width="56" height="15" uuid="012f9bcb-4278-44a9-b9d8-d6b80a2c9794"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{WAKTU}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement x="56" y="0" width="148" height="15" uuid="89893295-66f2-4e45-8072-24a86865a183"/>
                <textElement textAlignment="Right">
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[new DecimalFormat("#,##0.000").format($F{EI_QTY})]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement x="203" y="0" width="148" height="15" uuid="2952fe7c-82eb-4d75-ab6d-2c1d58e4bef3"/>
                <textElement textAlignment="Right">
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[new DecimalFormat("#,##0.000").format($F{TA_QTY})]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement x="350" y="0" width="148" height="15" uuid="a93cff3b-779c-480b-97e2-1ace6c525c33"/>
                <textElement textAlignment="Right">
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[new DecimalFormat("#,##0.000").format($F{EI_QTY} + $F{TA_QTY})]]></textFieldExpression>
            </textField>
        </band>
    </detail>
    <summary>
        <band height="42" splitType="Stretch">
            <line>
                <reportElement x="1" y="0" width="554" height="1" uuid="b7405f8e-e9ec-48cd-a2c2-aaa5cbea1c9a"/>
            </line>
            <staticText>
                <reportElement x="24" y="1" width="53" height="15" uuid="429c28de-8bd5-4ad7-8f12-3bacdfb41d43"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <text><![CDATA[TOTAL]]></text>
            </staticText>
            <textField>
                <reportElement x="56" y="1" width="148" height="15" uuid="058a2704-9a44-4055-9abc-42314a4c2034"/>
                <textElement textAlignment="Right">
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[new DecimalFormat("#,##0.000").format($V{totalQtyEI})]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement x="203" y="1" width="148" height="15" uuid="f1a4b378-157a-4d02-bbab-a4dcae8a23a2"/>
                <textElement textAlignment="Right">
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[new DecimalFormat("#,##0.000").format($V{totalQtyTA})]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement x="350" y="1" width="148" height="15" uuid="1ac99609-7bab-40e7-b52c-31a2dd35adf8"/>
                <textElement textAlignment="Right">
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[new DecimalFormat("#,##0.000").format($V{totalQtyEI} + $V{totalQtyTA})]]></textFieldExpression>
            </textField>
        </band>
    </summary>
</jasperReport>
