<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="salesDate" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="70dce86b-f548-4d5c-a232-910967db12e0">
    <property name="ireport.zoom" value="1.6105100000000074"/>
    <property name="ireport.x" value="0"/>
    <property name="ireport.y" value="0"/>
    <parameter name="outletCode" class="java.lang.String">
        <defaultValueExpression><![CDATA[]]></defaultValueExpression>
    </parameter>
    <parameter name="fromDate" class="java.lang.String">
        <defaultValueExpression><![CDATA[]]></defaultValueExpression>
    </parameter>
    <parameter name="toDate" class="java.lang.String">
        <defaultValueExpression><![CDATA[]]></defaultValueExpression>
    </parameter>
    <parameter name="posCode" class="java.lang.String">
        <defaultValueExpression><![CDATA[]]></defaultValueExpression>
    </parameter>
    <parameter name="posCode1" class="java.lang.String">
        <defaultValueExpression><![CDATA[]]></defaultValueExpression>
    </parameter>
    <parameter name="posCode2" class="java.lang.String">
        <defaultValueExpression><![CDATA[]]></defaultValueExpression>
    </parameter>
    <parameter name="cashierCode" class="java.lang.String">
        <defaultValueExpression><![CDATA[]]></defaultValueExpression>
    </parameter>
    <parameter name="cashierCode1" class="java.lang.String">
        <defaultValueExpression><![CDATA[]]></defaultValueExpression>
    </parameter>
    <parameter name="cashierCode2" class="java.lang.String">
        <defaultValueExpression><![CDATA[]]></defaultValueExpression>
    </parameter>
    <parameter name="shiftCode" class="java.lang.String">
        <defaultValueExpression><![CDATA[]]></defaultValueExpression>
    </parameter>
    <parameter name="shiftCode1" class="java.lang.String">
        <defaultValueExpression><![CDATA[]]></defaultValueExpression>
    </parameter>
    <parameter name="shiftCode2" class="java.lang.String">
        <defaultValueExpression><![CDATA[]]></defaultValueExpression>
    </parameter>
    <parameter name="outletName" class="java.lang.String"/>
    <parameter name="user" class="java.lang.String"/>
    <queryString>
        <![CDATA[select * from(
select TOTAL_PENDAPATAN,
TOTAL_PENJUALAN,
TOTAL_PENJUALAN_FNB,
TOTAL_PENJUALAN_CD,
KUPON_DIGUNAKAN,
KUPON_TERPAKAI,
DEBIT,
BCA,
MANDIRI,
BNI,
BRI,
OTR,
KEMBALIAN   ,
BIAYA_ANTAR ,
TAX_BIAYA_ANTAR,
DONASI,
DITERIMACSH ,
DITERIMAVCR ,
DITERIMADEBIT,
CASH,
TAXABLE,
PAJAK_RESTORAN,
PPN,
PEMBULATAN,
GROSS_SALES,
MODAL,
CASH_PULL
from(
select'XX' pid,total_pendapatan,total_penjualan,total_penjualan_fnb,total_penjualan_cd,kupon_digunakan,kupon_terpakai,debit,BCA,MANDIRI,BNI,BRI,OTR,kembalian,biaya_antar,tax_biaya_antar,donasi,
DITERIMACSH,DITERIMAVCR,DITERIMADEBIT,0 as CASH,taxable,pajak_restoran,ppn,pembulatan,gross_sales,modal,cash_pull
 from (select 'XX' pid,total_pendapatan,a as total_penjualan,(a-amt_cd)total_penjualan_fnb,amt_cd as total_penjualan_cd,
kupon_digunakan,kupon_terpakai,debit,BCA,MANDIRI,BNI,BRI,OTR,0 as kembalian, c as biaya_antar,k as tax_biaya_antar,j as donasi,
taxable,((d-tax_cd)+k)pajak_restoran,tax_cd ppn,total_pendapatan as gross_sales, ((total_pendapatan-taxable)-((d-tax_cd)+k))-tax_cd as pembulatan,modal,cash_pull
from(
select 'XX' pid,
sum(total_amount)a,sum(total_discount)b,sum(total_charge)c,sum(total_tax)d,sum(total_rounding)e,sum(total_sales)f,
sum(total_dp_paid)g,sum(total_payment)h,sum(total_sales)-sum(total_charge) as total_pendapatan,sum(total_donation)j,sum(total_tax_charge)k,sum(total_amount)-sum(total_discount)taxable
from t_pos_bill where
OUTLET_CODE IN ($P{outletCode})
AND TRANS_DATE BETWEEN $P{fromDate} AND $P{toDate}
AND POS_CODE BETWEEN $P{posCode1} AND $P{posCode2}
AND CASHIER_CODE BETWEEN $P{cashierCode1} AND $P{cashierCode2}
AND SHIFT_CODE BETWEEN $P{shiftCode1} AND $P{shiftCode2}
AND delivery_status='CLS') a
join
(SELECT   'XX' pid, SUM (amount) amt_cd, SUM (amt_tax) tax_cd FROM   (SELECT   x.*
 FROM (
 SELECT * FROM t_pos_bill_item_detail WHERE TRANS_DATE BETWEEN $P{fromDate} AND  $P{toDate} AND POS_CODE BETWEEN $P{posCode1} AND  $P{posCode2}
 AND menu_item_code IN (SELECT   menu_item_code FROM m_menu_item WHERE   menu_group_code ='G07'
    UNION ALL
SELECT   modifier_item_code FROM m_modifier_item WHERE   modifier_group_code IN ('M1Q','M19','M20')))x
JOIN (SELECT * FROM t_pos_bill WHERE   TRANS_DATE BETWEEN $P{fromDate} AND  $P{toDate}
AND POS_CODE BETWEEN $P{posCode1} AND $P{posCode2}
AND delivery_status = 'CLS') y
ON x.outlet_code = y.outlet_code AND x.pos_code = y.pos_code
AND x.day_seq = y.day_seq
AND x.bill_no = y.bill_no)) b
ON a.pid = b.pid
join
(SELECT 'XX' pid, sum(payment_amount)kupon_digunakan,sum(payment_used)kupon_terpakai
from t_pos_bill_payment where TRANS_DATE BETWEEN $P{fromDate} AND  $P{toDate} AND POS_CODE BETWEEN $P{posCode1} AND  $P{posCode2} and payment_method_code='VCR' ) c
ON a.pid = c.pid
join
(SELECT 'XX' pid, sum(payment_used)debit
from t_pos_bill_payment where TRANS_DATE BETWEEN $P{fromDate} AND  $P{toDate} AND POS_CODE BETWEEN $P{posCode1} AND  $P{posCode2}
and payment_method_code in(select payment_method_code from m_payment_method where payment_type_code='DBT')) d
ON a.pid = d.pid
join
(SELECT 'XX' pid, sum(payment_used)BCA
from t_pos_bill_payment where TRANS_DATE BETWEEN $P{fromDate} AND  $P{toDate} AND POS_CODE BETWEEN $P{posCode1} AND  $P{posCode2}
and payment_method_code='BCA') e
ON a.pid = e.pid
join
(SELECT 'XX' pid, sum(payment_used)MANDIRI
from t_pos_bill_payment where TRANS_DATE BETWEEN $P{fromDate} AND  $P{toDate} AND POS_CODE BETWEEN $P{posCode1} AND  $P{posCode2}
and payment_method_code='MND') f
ON a.pid = f.pid
join
(SELECT 'XX' pid, sum(payment_used)BNI
from t_pos_bill_payment where TRANS_DATE BETWEEN $P{fromDate} AND  $P{toDate} AND POS_CODE BETWEEN $P{posCode1} AND  $P{posCode2}
and payment_method_code='BNI') g
ON a.pid = g.pid
join
(SELECT 'XX' pid, sum(payment_used)BRI
from t_pos_bill_payment where TRANS_DATE BETWEEN $P{fromDate} AND  $P{toDate} AND POS_CODE BETWEEN $P{posCode1} AND  $P{posCode2}
and payment_method_code='BRI') h
ON a.pid = h.pid
join
(SELECT 'XX' pid, sum(payment_used)OTR
from t_pos_bill_payment where TRANS_DATE BETWEEN $P{fromDate} AND  $P{toDate} AND POS_CODE BETWEEN $P{posCode1} AND  $P{posCode2}
and payment_method_code not in('BNI','BCA','VCR','MND','BRI','CSH')) i
ON a.pid = i.pid
join
(SELECT 'XX'pid,sum(trans_amount)modal from t_pos_day_trans where trans_date BETWEEN $P{fromDate} AND  $P{toDate} AND POS_CODE BETWEEN $P{posCode1} AND  $P{posCode2}  and trans_code='OPF')j
ON a.pid = j.pid
join
(SELECT 'XX'pid,sum(trans_amount)cash_pull from t_pos_day_trans where trans_date BETWEEN $P{fromDate} AND  $P{toDate} AND POS_CODE BETWEEN $P{posCode1} AND  $P{posCode2}  and trans_code in('SLS','OPF','DP','DNT'))k
ON a.pid = k.pid)a
join
(select 'XX'pid,DITERIMACSH,DITERIMAVCR,DITERIMADEBIT from(
(select 'XX'pid,sum(CSH)DITERIMACSH,sum(VCR)DITERIMAVCR,sum(DEBIT)DITERIMADEBIT from (
select 'XX'pid,
case when payment_method_code='CSH' then sum(payment_used) else 0 end as CSH,
case when payment_method_code='VCR' then sum(payment_used) else 0 end as VCR,
case when payment_method_code not in('CSH','VCR') then sum(payment_used) else 0 end as debit
from t_pos_book_payment where TRANS_DATE BETWEEN $P{fromDate} AND  $P{toDate} group by payment_method_code))))l
ON a.pid = l.pid))

unpivot

(V  FOR K IN(
TOTAL_PENDAPATAN ,
TOTAL_PENJUALAN ,
TOTAL_PENJUALAN_FNB ,
TOTAL_PENJUALAN_CD ,
KUPON_DIGUNAKAN ,
KUPON_TERPAKAI ,
DEBIT ,
BCA ,
MANDIRI ,
BNI ,
BRI ,
OTR ,
KEMBALIAN ,
BIAYA_ANTAR ,
TAX_BIAYA_ANTAR ,
DONASI ,
DITERIMACSH ,
DITERIMAVCR ,
DITERIMADEBIT ,
CASH ,
TAXABLE ,
PAJAK_RESTORAN ,
PPN ,
PEMBULATAN ,
GROSS_SALES ,
MODAL ,
CASH_PULL
))
U]]>
    </queryString>
    <field name="K" class="java.lang.String"/>
    <field name="V" class="java.math.BigDecimal"/>
    <background>
        <band splitType="Stretch"/>
    </background>
    <columnHeader>
        <band height="98" splitType="Stretch">
            <staticText>
                <reportElement x="5" y="78" width="100" height="20" uuid="68be17c9-a449-4f20-b2b1-c8d696905599"/>
                <text><![CDATA[Keterangan]]></text>
            </staticText>
            <staticText>
                <reportElement x="450" y="78" width="100" height="20" uuid="11a413b1-7c6a-4686-8840-352600dae2b8"/>
                <text><![CDATA[Nilai]]></text>
            </staticText>
            <line>
                <reportElement x="2" y="96" width="552" height="1" uuid="074a96c7-79f9-492b-b598-dfb89675a4ba"/>
            </line>
            <line>
                <reportElement x="2" y="78" width="552" height="1" uuid="220c2045-a0e6-4c09-8e8b-6f39808cd864"/>
            </line>
            <staticText>
                <reportElement x="196" y="28" width="161" height="19" uuid="ef16a081-aae5-409c-8f96-d1677b920d8e"/>
                <textElement textAlignment="Center">
                    <font size="12" isBold="true"/>
                </textElement>
                <text><![CDATA[Sales By Date]]></text>
            </staticText>
            <image>
                <reportElement x="21" y="0" width="56" height="42" isPrintWhenDetailOverflows="true" uuid="6b7f9666-f046-4f4c-be14-b871ba198ca5"/>
                <imageExpression><![CDATA["logo/logoKfc.png"]]></imageExpression>
            </image>
            <staticText>
                <reportElement x="78" y="0" width="112" height="11" uuid="500b4672-efad-4caa-9a0b-1da5628e7662"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <text><![CDATA[PT. Fastfood Indonesia, Tbk]]></text>
            </staticText>
            <staticText>
                <reportElement x="3" y="66" width="55" height="11" uuid="67b03c99-a623-4262-9307-c1c9a80eae0a"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <text><![CDATA[Periode   ]]></text>
            </staticText>
            <textField>
                <reportElement x="57" y="66" width="236" height="11" uuid="0daa34cb-b8f8-422b-8564-cbe3f7cde39e"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[" : " + new SimpleDateFormat("dd/MM/yyyy").format(new SimpleDateFormat("dd-MMM-yy").parse($P{fromDate}))
+ " s/d " + new SimpleDateFormat("dd/MM/yyyy").format(new SimpleDateFormat("dd-MMM-yy").parse($P{toDate}))]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement x="78" y="10" width="141" height="11" uuid="1f271f3b-3000-4071-80b1-de01c66d2668"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[$P{outletName}]]></textFieldExpression>
            </textField>
            <staticText>
                <reportElement x="397" y="46" width="55" height="11" uuid="bc02c070-7050-4db4-b27a-9d8e87332c4d"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <text><![CDATA[Pos]]></text>
            </staticText>
            <staticText>
                <reportElement x="3" y="56" width="55" height="11" uuid="c89c7c49-f572-4534-99c7-ee9bef63687c"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <text><![CDATA[Cashier ]]></text>
            </staticText>
            <staticText>
                <reportElement x="397" y="66" width="55" height="11" uuid="55f4928f-198f-4db1-8e23-fb602b2f3589"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <text><![CDATA[Shift]]></text>
            </staticText>
            <staticText>
                <reportElement x="397" y="56" width="55" height="11" uuid="79dd4346-d2c2-4163-9b65-65daa6f94c50"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <text><![CDATA[User ]]></text>
            </staticText>
            <textField>
                <reportElement x="451" y="56" width="150" height="11" uuid="f6c34652-9cad-4ab1-8049-a5179913745a"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[" : " + $P{user}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement x="494" y="1" width="150" height="11" uuid="ea79cb17-f4e7-41ea-88c0-fc38573510b6"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[" : " + $V{PAGE_NUMBER}]]></textFieldExpression>
            </textField>
            <staticText>
                <reportElement x="440" y="1" width="55" height="11" uuid="1183a193-f824-429e-8b33-687d1966a6c1"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <text><![CDATA[Halaman]]></text>
            </staticText>
            <textField>
                <reportElement x="57" y="56" width="211" height="11" uuid="e2713941-49de-43f2-a116-c42b27482ec1"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[" : " + $P{cashierCode}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement x="451" y="46" width="150" height="11" uuid="c916868d-befd-4887-b656-a4f64c107937"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[" : " + $P{posCode}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement x="451" y="66" width="150" height="11" uuid="3245e8b1-dedf-400b-9ff4-73391f7b2aa1"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[" : " + $P{shiftCode}]]></textFieldExpression>
            </textField>
        </band>
    </columnHeader>
    <detail>
        <band height="25" splitType="Stretch">
            <textField>
                <reportElement x="5" y="0" width="140" height="20" uuid="605c2bb0-8765-4d06-8445-5f2cb0ec2525"/>
                <textFieldExpression><![CDATA[$F{K}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement x="450" y="0" width="100" height="20" uuid="546ac859-4792-4190-b188-4c213490d857"/>
                <textFieldExpression><![CDATA[new DecimalFormat("#,##0.00").format($F{V})]]></textFieldExpression>
            </textField>
        </band>
    </detail>
    <pageFooter>
        <band height="20">
            <textField>
                <reportElement x="105" y="6" width="150" height="11" uuid="127fbb15-6f89-4a19-a941-de430a25dd17"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[" : " + new SimpleDateFormat("dd/MM/yyyy hh:mm:ss").format(new Date())]]></textFieldExpression>
            </textField>
            <staticText>
                <reportElement x="3" y="6" width="103" height="11" uuid="d794a27a-9463-4440-9819-8533216b01dc"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <text><![CDATA[Tanggal dan Jan Cetak ]]></text>
            </staticText>
        </band>
    </pageFooter>
    <summary>
        <band height="42" splitType="Stretch"/>
    </summary>
</jasperReport>
