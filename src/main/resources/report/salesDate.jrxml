<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="salesDate" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="70dce86b-f548-4d5c-a232-910967db12e0">
    <property name="ireport.zoom" value="1.6105100000000074"/>
    <property name="ireport.x" value="0"/>
    <property name="ireport.y" value="0"/>
    <parameter name="outletCode" class="java.lang.String">
        <defaultValueExpression><![CDATA[]]></defaultValueExpression>
    </parameter>
    <parameter name="fromDate" class="java.lang.String">
        <defaultValueExpression><![CDATA[]]></defaultValueExpression>
    </parameter>
    <parameter name="toDate" class="java.lang.String">
        <defaultValueExpression><![CDATA[]]></defaultValueExpression>
    </parameter>
    <parameter name="posCode" class="java.lang.String">
        <defaultValueExpression><![CDATA[]]></defaultValueExpression>
    </parameter>
    <parameter name="posCode1" class="java.lang.String">
        <defaultValueExpression><![CDATA[]]></defaultValueExpression>
    </parameter>
    <parameter name="posCode2" class="java.lang.String">
        <defaultValueExpression><![CDATA[]]></defaultValueExpression>
    </parameter>
    <parameter name="cashierCode" class="java.lang.String">
        <defaultValueExpression><![CDATA[]]></defaultValueExpression>
    </parameter>
    <parameter name="cashierCode1" class="java.lang.String">
        <defaultValueExpression><![CDATA[]]></defaultValueExpression>
    </parameter>
    <parameter name="cashierCode2" class="java.lang.String">
        <defaultValueExpression><![CDATA[]]></defaultValueExpression>
    </parameter>
    <parameter name="shiftCode" class="java.lang.String">
        <defaultValueExpression><![CDATA[]]></defaultValueExpression>
    </parameter>
    <parameter name="shiftCode1" class="java.lang.String">
        <defaultValueExpression><![CDATA[]]></defaultValueExpression>
    </parameter>
    <parameter name="shiftCode2" class="java.lang.String">
        <defaultValueExpression><![CDATA[]]></defaultValueExpression>
    </parameter>
    <parameter name="orderTypeCode1" class="java.lang.String">
        <defaultValueExpression><![CDATA[]]></defaultValueExpression>
    </parameter>
    <parameter name="orderTypeCode2" class="java.lang.String">
        <defaultValueExpression><![CDATA[]]></defaultValueExpression>
    </parameter>
    <parameter name="orderTypeName" class="java.lang.String"/>
    <parameter name="outletName" class="java.lang.String"/>
    <parameter name="user" class="java.lang.String"/>
    <queryString>
        <![CDATA[SELECT
	*
FROM
	(
	SELECT
		TOTAL_PENDAPATAN,
		TOTAL_PENJUALAN,
		TOTAL_PENJUALAN_FNB,
		AMT_CD,
		CHARGE_BILL,
		TAX_CHARGE_BILL,
		TAXABLE,
		TAX,
		PPN,
		ROUNDING_BILL,
		GROSS_SALES,
		TOTAL_DP_PAID,
		TOTAL_REFUND,
		TRANSAKSI,
		CUSTOMER,
		DISCOUNT,
		DONASI,
		TICKET_AVG,
		CUST_AVERAGE,
		TOTAL_CLAIM
	FROM
		(
		SELECT
			sales_bill - charge_bill total_pendapatan,
			amt_bill total_penjualan,
			amt_bill - amt_cd total_penjualan_fnb,
			amt_cd,
			charge_bill,
			tax_charge_bill,
			amt_bill - discount_bill taxable,
			tax_bill - tax_cd + tax_charge_bill TAX,
			tax_cd ppn,
			rounding_bill,
			sales_bill - charge_bill gross_sales,
			total_dp_paid,
			total_refund,
			transaksi,
			customer,
			discount,
			donasi,
			TICKET_AVG,
			CUST_AVERAGE,
			total_claim
		FROM
			(
			SELECT
				'XX' pid,
				SUM (total_amount) amt_bill,
				SUM (total_discount) discount_bill,
				SUM (total_tax) tax_bill,
				SUM (total_rounding) rounding_bill,
				SUM (total_charge) charge_bill,
				SUM (total_tax_charge) tax_charge_bill,
				SUM (total_sales) sales_bill,
				SUM (total_dp_paid) total_dp_paid,
				SUM (total_refund) total_refund,
				COUNT (bill_no) transaksi,
				SUM (total_customer) customer,
				SUM (total_discount) discount,
				SUM (total_donation) donasi,
				ROUND( (SUM (TOTAL_AMOUNT)
- SUM (TOTAL_DISCOUNT))
/ (NVL (SUM (TOTAL_CUSTOMER), 1)))
CUST_AVERAGE,
				ROUND( (SUM (TOTAL_AMOUNT)
- SUM (TOTAL_DISCOUNT))
/ (COUNT (1)))
TICKET_AVG,
				0 AS TOTAL_CLAIM
			FROM
				t_pos_bill
			WHERE
				(DELIVERY_STATUS IN (' ', 'CLS')
					OR DELIVERY_STATUS IS NULL)
				AND OUTLET_CODE IN ($P{outletCode})
				AND TRANS_DATE BETWEEN $P{fromDate}
AND $P{toDate}
				AND POS_CODE BETWEEN $P{posCode1} AND $P{posCode2}
				AND CASHIER_CODE BETWEEN $P{cashierCode1} AND $P{cashierCode2}
				AND SHIFT_CODE BETWEEN $P{shiftCode1} AND $P{shiftCode2}
				AND order_type IN
(
				SELECT
					CODE
				FROM
					M_GLOBAL
				WHERE
					COND LIKE '%ORDER_TYPE%'
					AND CODE BETWEEN $P{orderTypeCode1}
AND $P{orderTypeCode2}))
a
		JOIN
(
			SELECT
				'XX' pid,
				SUM (amount) amt_cd,
				SUM (amt_tax) tax_cd
			FROM
				(
				SELECT
					x.*
				FROM
					(
					SELECT
						*
					FROM
						t_pos_bill_item_detail
					WHERE
						TRANS_DATE BETWEEN $P{fromDate}
AND $P{toDate}
						AND POS_CODE BETWEEN $P{posCode1}
AND $P{posCode2}
						AND menu_item_code IN
(
						SELECT
							menu_item_code
						FROM
							m_menu_item
						WHERE
							menu_group_code =
'G07'
					UNION ALL
						SELECT
							modifier_item_code
						FROM
							m_modifier_item
						WHERE
							modifier_group_code IN
('M1Q',
'M19',
'M20')))
x
				JOIN
(
					SELECT
						*
					FROM
						t_pos_bill
					WHERE
						TRANS_DATE BETWEEN $P{fromDate}
AND $P{toDate}
						AND POS_CODE BETWEEN $P{posCode1}
AND $P{posCode2}
						AND delivery_status =
'CLS') y
ON
					x.outlet_code = y.outlet_code
					AND x.pos_code = y.pos_code
					AND x.day_seq = y.day_seq
					AND x.bill_no = y.bill_no)) b
ON
			a.pid = b.pid))T

unpivot (
v FOR k IN (TOTAL_PENDAPATAN,
TOTAL_PENJUALAN,
TOTAL_PENJUALAN_FNB,
AMT_CD,
CHARGE_BILL,
TAX_CHARGE_BILL,
TAXABLE,
TAX,
PPN,
ROUNDING_BILL,
GROSS_SALES,
TOTAL_DP_PAID,
TOTAL_REFUND,
TRANSAKSI,
CUSTOMER,
DISCOUNT,
DONASI,
TICKET_AVG,
CUST_AVERAGE,
TOTAL_CLAIM
)
) u]]>
    </queryString>
    <field name="K" class="java.lang.String"/>
    <field name="V" class="java.math.BigDecimal"/>
    <background>
        <band splitType="Stretch"/>
    </background>
    <columnHeader>
        <band height="98" splitType="Stretch">
            <staticText>
                <reportElement x="58" y="78" width="100" height="20" uuid="68be17c9-a449-4f20-b2b1-c8d696905599"/>
                <text><![CDATA[Keterangan]]></text>
            </staticText>
            <staticText>
                <reportElement x="363" y="78" width="100" height="20" uuid="11a413b1-7c6a-4686-8840-352600dae2b8"/>
                <text><![CDATA[Nilai]]></text>
            </staticText>
            <line>
                <reportElement x="2" y="96" width="552" height="1" uuid="074a96c7-79f9-492b-b598-dfb89675a4ba"/>
            </line>
            <line>
                <reportElement x="2" y="78" width="552" height="1" uuid="220c2045-a0e6-4c09-8e8b-6f39808cd864"/>
            </line>
            <staticText>
                <reportElement x="369" y="0" width="161" height="19" uuid="ef16a081-aae5-409c-8f96-d1677b920d8e"/>
                <textElement textAlignment="Center">
                    <font size="12" isBold="true"/>
                </textElement>
                <text><![CDATA[Daily Sales Report]]></text>
            </staticText>
            <image>
                <reportElement x="21" y="0" width="56" height="42" isPrintWhenDetailOverflows="true" uuid="6b7f9666-f046-4f4c-be14-b871ba198ca5"/>
                <imageExpression><![CDATA["logo/logoKfc.png"]]></imageExpression>
            </image>
            <staticText>
                <reportElement x="78" y="0" width="112" height="11" uuid="500b4672-efad-4caa-9a0b-1da5628e7662"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <text><![CDATA[PT. Fastfood Indonesia, Tbk]]></text>
            </staticText>
            <staticText>
                <reportElement x="3" y="66" width="55" height="11" uuid="67b03c99-a623-4262-9307-c1c9a80eae0a"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <text><![CDATA[Periode   ]]></text>
            </staticText>
            <staticText>
                <reportElement x="3" y="46" width="55" height="11" uuid="4801c6f7-3a66-457b-9a9e-5aa72426cd1d"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <text><![CDATA[Order Type ]]></text>
            </staticText>
            <textField>
                <reportElement x="57" y="46" width="141" height="11" uuid="717d6876-c0b5-4fbd-bb28-0ddec0ec2b5a"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[" : " + $P{orderTypeName}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement x="57" y="66" width="236" height="11" uuid="0daa34cb-b8f8-422b-8564-cbe3f7cde39e"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[" : " + new SimpleDateFormat("dd/MM/yyyy").format(new SimpleDateFormat("dd-MMM-yy").parse($P{fromDate}))
+ " s/d " + new SimpleDateFormat("dd/MM/yyyy").format(new SimpleDateFormat("dd-MMM-yy").parse($P{toDate}))]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement x="78" y="10" width="141" height="11" uuid="1f271f3b-3000-4071-80b1-de01c66d2668"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[$P{outletName}]]></textFieldExpression>
            </textField>
            <staticText>
                <reportElement x="350" y="46" width="55" height="11" uuid="bc02c070-7050-4db4-b27a-9d8e87332c4d"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <text><![CDATA[Pos]]></text>
            </staticText>
            <staticText>
                <reportElement x="3" y="56" width="55" height="11" uuid="c89c7c49-f572-4534-99c7-ee9bef63687c"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <text><![CDATA[Cashier ]]></text>
            </staticText>
            <staticText>
                <reportElement x="350" y="66" width="55" height="11" uuid="55f4928f-198f-4db1-8e23-fb602b2f3589"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <text><![CDATA[Shift]]></text>
            </staticText>
            <staticText>
                <reportElement x="350" y="56" width="55" height="11" uuid="79dd4346-d2c2-4163-9b65-65daa6f94c50"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <text><![CDATA[User ]]></text>
            </staticText>
            <textField>
                <reportElement x="404" y="56" width="150" height="11" uuid="f6c34652-9cad-4ab1-8049-a5179913745a"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[" : " + $P{user}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement x="404" y="36" width="150" height="11" uuid="ea79cb17-f4e7-41ea-88c0-fc38573510b6"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[" : " + new SimpleDateFormat("dd/MM/yyyy hh:mm:ss").format(new Date())]]></textFieldExpression>
            </textField>
            <staticText>
                <reportElement x="350" y="36" width="55" height="11" uuid="1183a193-f824-429e-8b33-687d1966a6c1"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <text><![CDATA[Tanggal Cetak ]]></text>
            </staticText>
            <textField>
                <reportElement x="57" y="56" width="211" height="11" uuid="e2713941-49de-43f2-a116-c42b27482ec1"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[" : " + $P{cashierCode}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement x="404" y="46" width="150" height="11" uuid="c916868d-befd-4887-b656-a4f64c107937"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[" : " + $P{posCode}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement x="404" y="66" width="150" height="11" uuid="3245e8b1-dedf-400b-9ff4-73391f7b2aa1"/>
                <textElement>
                    <font size="8"/>
                </textElement>
                <textFieldExpression><![CDATA[" : " + $P{shiftCode}]]></textFieldExpression>
            </textField>
        </band>
    </columnHeader>
    <detail>
        <band height="25" splitType="Stretch">
            <textField>
                <reportElement x="58" y="0" width="140" height="20" uuid="605c2bb0-8765-4d06-8445-5f2cb0ec2525"/>
                <textFieldExpression><![CDATA[$F{K}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement x="363" y="0" width="100" height="20" uuid="546ac859-4792-4190-b188-4c213490d857"/>
                <textFieldExpression><![CDATA[new DecimalFormat("#,##0.00").format($F{V})]]></textFieldExpression>
            </textField>
        </band>
    </detail>
    <summary>
        <band height="42" splitType="Stretch"/>
    </summary>
</jasperReport>
